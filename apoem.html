<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Valentine's Day</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            overflow: hidden;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .start-screen {
            text-align: center;
            color: white;
            cursor: pointer;
            transition: transform 0.3s;
        }

        .start-screen:hover {
            transform: scale(1.05);
        }

        .start-screen h1 {
            font-size: 3rem;
            margin-bottom: 2rem;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .start-screen p {
            font-size: 1.5rem;
            opacity: 0.8;
        }

        .slideshow-container {
            display: none;
            width: 100%;
            height: 100vh;
            position: relative;
        }

        .slide {
            display: none;
            width: 100%;
            height: 100%;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            padding: 2rem;
            animation: fadeIn 1s;
        }

        .slide.active {
            display: flex;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: scale(0.95); }
            to { opacity: 1; transform: scale(1); }
        }

        .slide img {
            max-width: 500px;
            max-height: 500px;
            border-radius: 20px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
            margin-bottom: 2rem;
            object-fit: cover;
        }

        .slide h2 {
            font-size: 2rem;
            color: white;
            margin-bottom: 1.5rem;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
            font-weight: normal;
        }

        .slide p {
            font-size: 2rem;
            color: white;
            max-width: 700px;
            line-height: 1.6;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .question-container {
            display: none;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            height: 100vh;
            text-align: center;
            padding: 2rem;
        }

        .question-container h2 {
            font-size: 3rem;
            color: white;
            margin-bottom: 3rem;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        .buttons {
            display: flex;
            gap: 2rem;
        }

        .btn {
            padding: 1.5rem 3rem;
            font-size: 1.5rem;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: bold;
            box-shadow: 0 5px 20px rgba(0,0,0,0.3);
        }

        .btn-yes {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
        }

        .btn-yes:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(245, 87, 108, 0.5);
        }

        .btn-no {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            position: relative;
        }

        .btn-no:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(79, 172, 254, 0.5);
        }

        .result {
            display: none;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            height: 100vh;
            text-align: center;
            padding: 2rem;
        }

        .result h2 {
            font-size: 3rem;
            color: white;
            margin-bottom: 2rem;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .result p {
            font-size: 1.5rem;
            color: rgba(255,255,255,0.9);
        }

        .hearts {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            overflow: hidden;
        }

        .heart {
            position: absolute;
            bottom: -50px;
            font-size: 2rem;
            animation: float 6s linear infinite;
            opacity: 0;
        }

        @keyframes float {
            0% {
                bottom: -50px;
                opacity: 1;
            }
            100% {
                bottom: 100vh;
                opacity: 0;
                transform: translateX(100px);
            }
        }

        .hidden {
            display: none !important;
        }

        /* ÁïôË®ÄËæìÂÖ•Ê°ÜÊ†∑Âºè */
        #messageInput::placeholder {
            color: rgba(255, 255, 255, 0.6);
        }

        #messageInput:focus {
            outline: none;
            border-color: rgba(255, 255, 255, 0.6);
            background: rgba(255, 255, 255, 0.25);
        }

        .star {
            transition: all 0.2s;
            user-select: none;
            position: relative;
            display: inline-block;
            width: 1em;
            text-align: center;
        }

        .star:hover {
            transform: scale(1.2);
        }

        .star.full {
            color: #FFD700;
        }

        .star.half {
            color: #FFD700;
        }

        .stars-container.disabled .star {
            cursor: default;
        }
    </style>

    <!-- EmailJS SDK -->
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js"></script>
    <script type="text/javascript">
        (function(){
            emailjs.init("D-kNUaEVGNWL4R9DH"); // ‰Ω†ÁöÑ Public Key
        })();
    </script>
</head>
<body>
    <!-- ËÉåÊôØÈü≥‰πê -->
    <audio id="bgMusic" loop preload="auto" autoplay>
        <source src="Come_Here.mp3" type="audio/mpeg">
        ÊÇ®ÁöÑÊµèËßàÂô®‰∏çÊîØÊåÅÈü≥È¢ëÊí≠Êîæ„ÄÇ
    </audio>

    <!-- Áà±ÂøÉÁâπÊïàÂÆπÂô® -->
    <div class="hearts" id="hearts"></div>

    <!-- ÂºÄÂßãÈ°µÈù¢ -->
    <div class="start-screen" id="startScreen">
        <h1 style="font-size: 1.8rem; font-weight: normal; line-height: 1.8;">You can laugh at me for this. </h1>
        <button style="margin-top: 2rem; padding: 0.8rem 2.5rem; font-size: 1.2rem; border: none; border-radius: 50px; background: rgba(255,255,255,0.2); color: white; cursor: pointer; transition: all 0.3s; backdrop-filter: blur(5px);" onmouseover="this.style.background='rgba(255,255,255,0.35)'" onmouseout="this.style.background='rgba(255,255,255,0.2)'">Continue</button>
    </div>

    <!-- ÂπªÁÅØÁâáÂÆπÂô® -->
    <div class="slideshow-container" id="slideshowContainer">
        <div class="slide">
            <h2>Hey, Chang, I am not that shy.</h2>
            <p>When you called me at that night,</p>
        </div>

        <div class="slide">
            <h2>To chat you asked me if I'd like. </h2>
            <p>I was actually afraid of being denied,</p>
        </div>

        <div class="slide">
            <h2>The invitation from my side.</h2>
            <p>Didn't mean to push you too tight.</p>
        </div>

        <div class="slide">
            <h2>We haven't known each other for a while,</h2>
            <p>But I like to stay with you ‚Äî the time flies.</p>
        </div>

        <div class="slide">
            <h2>We talked about Britpop, Firenze and the movies we like, </h2>
            <p>This is the rhyme in my mind.</p>
        </div>

        <div class="slide">
            <h2>I am a wannabe poet like the one in Before Sunrise.</h2>
            <p>No plan needs to be well-designed, let's go out, chill and find.</p>
        </div>

        <div class="slide">
            <h2>Going hiking or sitting beside,</h2>
            <p>Having fine dining, or dim sum and fried rice.</p>
        </div>

        <div class="slide">
            <h2>Now I am listening to spotify,</h2>
            <p>Thom Yorke, the weird guy.</p>
        </div>

        <div class="slide">
            <h2>There is one song I like,</h2>
            <p>Don't leave me "high and dry".</p>
        </div>

        <div class="slide">
            <h2>The weather will be fine.</h2>¬∑
            <p>All right.</p>
        </div>
    </div>

    <!-- ÈóÆÈ¢òÁïåÈù¢ -->
    <div class="question-container" id="questionContainer">
        <h2>Would you be my date in the Valentine?</h2>
        <div class="buttons">
            <button class="btn btn-yes" id="btnYes">I Would</button>
            <button class="btn btn-no" id="btnNo">Hell No</button>
        </div>
    </div>

    <!-- ÁªìÊûúÁïåÈù¢ - Êé•Âèó -->
    <div class="result" id="resultYes">
        <h2 style="font-size: 2.5rem;">How do you think of my poem?</h2>
        <div id="ratingContainer" style="margin-top: 3rem;">
            <div class="stars-container" style="display: flex; justify-content: center; gap: 0.3rem; font-size: 3rem; cursor: pointer;">
                <span class="star" data-index="1">‚òÜ</span>
                <span class="star" data-index="2">‚òÜ</span>
                <span class="star" data-index="3">‚òÜ</span>
                <span class="star" data-index="4">‚òÜ</span>
                <span class="star" data-index="5">‚òÜ</span>
            </div>
            <p id="scoreDisplay" style="margin-top: 1rem; font-size: 1.5rem; opacity: 0.8;"></p>
        </div>
        <p id="ratingResult" style="margin-top: 1.5rem; font-size: 1.5rem; display: none;"></p>
    </div>

    <!-- ÁªìÊûúÁïåÈù¢ - ÊãíÁªù -->
    <div class="result" id="resultNo">
        <h2>üò¢</h2>
        <p>Ê≤°ÂÖ≥Á≥ªÔºåÊàë‰ºöÁªßÁª≠Âä™ÂäõÁöÑ...</p>
        <p style="margin-top: 2rem;">‰πüËÆ∏‰∏ãÊ¨°‰Ω†‰ºöÊîπÂèò‰∏ªÊÑè</p>
    </div>

    <script>
        const slideshowContainer = document.getElementById('slideshowContainer');
        const questionContainer = document.getElementById('questionContainer');
        const resultYes = document.getElementById('resultYes');
        const resultNo = document.getElementById('resultNo');
        const bgMusic = document.getElementById('bgMusic');
        const btnYes = document.getElementById('btnYes');
        const btnNo = document.getElementById('btnNo');
        const hearts = document.getElementById('hearts');

        let currentSlide = 0;
        const slides = document.querySelectorAll('.slide');
        const totalSlides = slides.length;

        // ËÆæÁΩÆÈü≥Èáè
        bgMusic.volume = 0.6; // Èü≥ÈáèËÆæÁΩÆ‰∏∫60%

        const startScreen = document.getElementById('startScreen');
        let slideInterval = 5000; // ÈªòËÆ§5Áßí

        // Ëé∑ÂèñÊ≠åÊõ≤Êó∂Èïø
        bgMusic.addEventListener('loadedmetadata', () => {
            const duration = bgMusic.duration;
            slideInterval = (duration / totalSlides / 2) * 1000;
            console.log('Ê≠åÊõ≤Êó∂Èïø:', duration, 'Áßí');
            console.log('ÊØèÂ∏ßÊó∂Èó¥:', (slideInterval / 1000).toFixed(1), 'Áßí');
        });

        // ÁÇπÂáªÂºÄÂßãÈ°µÈù¢ÂêéÂºÄÂßã
        startScreen.addEventListener('click', () => {
            startScreen.style.display = 'none';
            slideshowContainer.style.display = 'block';
            bgMusic.currentTime = 0;
            bgMusic.play();
            showSlide(0);
            startSlideshow(slideInterval);
        });

        // ÊòæÁ§∫ÊåáÂÆöÂπªÁÅØÁâá
        function showSlide(index) {
            slides.forEach(slide => slide.classList.remove('active'));
            slides[index].classList.add('active');
        }

        // Ëá™Âä®Êí≠ÊîæÂπªÁÅØÁâá
        function startSlideshow(intervalTime) {
            const interval = setInterval(() => {
                currentSlide++;
                if (currentSlide < totalSlides) {
                    showSlide(currentSlide);
                } else {
                    clearInterval(interval);
                    setTimeout(() => {
                        slideshowContainer.style.display = 'none';
                        questionContainer.style.display = 'flex';
                    }, 1000);
                }
            }, intervalTime);
        }

        // ÂàõÂª∫Áà±ÂøÉÁâπÊïà
        function createHeart() {
            const heart = document.createElement('div');
            heart.classList.add('heart');
            heart.textContent = '‚ù§Ô∏è';
            heart.style.left = Math.random() * 100 + '%';
            heart.style.animationDuration = (Math.random() * 3 + 4) + 's';
            heart.style.fontSize = (Math.random() * 20 + 20) + 'px';
            hearts.appendChild(heart);

            setTimeout(() => {
                heart.remove();
            }, 7000);
        }

        // ÊåâÈíÆÁÇπÂáª‰∫ã‰ª∂
        btnYes.addEventListener('click', () => {
            questionContainer.style.display = 'none';
            resultYes.style.display = 'flex';
        });

        btnNo.addEventListener('click', (e) => {
            e.preventDefault();
            const x = Math.random() * (window.innerWidth - btnNo.offsetWidth);
            const y = Math.random() * (window.innerHeight - btnNo.offsetHeight);
            btnNo.style.position = 'absolute';
            btnNo.style.left = x + 'px';
            btnNo.style.top = y + 'px';
        });

        // ÊòüÊòüËØÑÂàÜÁ≥ªÁªü
        const stars = document.querySelectorAll('.star');
        const starsContainer = document.querySelector('.stars-container');
        const scoreDisplay = document.getElementById('scoreDisplay');
        let rated = false;

        function updateStars(score) {
            stars.forEach(star => {
                const index = parseInt(star.getAttribute('data-index'));
                star.classList.remove('full', 'half');
                if (index <= Math.floor(score)) {
                    star.textContent = '‚òÖ';
                    star.classList.add('full');
                } else if (index === Math.ceil(score) && score % 1 !== 0) {
                    star.textContent = '‚òÖ';
                    star.classList.add('half');
                    star.style.background = 'linear-gradient(90deg, #FFD700 50%, white 50%)';
                    star.style.webkitBackgroundClip = 'text';
                    star.style.webkitTextFillColor = 'transparent';
                } else {
                    star.textContent = '‚òÜ';
                    star.style.background = 'none';
                    star.style.webkitTextFillColor = 'white';
                }
            });
        }

        // Èº†Ê†áÊÇ¨ÂÅúÔºöÊ†πÊçÆÁÇπÂáª‰ΩçÁΩÆÂà§Êñ≠Êï¥ÊòüÊàñÂçäÊòü
        stars.forEach(star => {
            star.addEventListener('mousemove', function(e) {
                if (rated) return;
                const index = parseInt(this.getAttribute('data-index'));
                const rect = this.getBoundingClientRect();
                const isHalf = (e.clientX - rect.left) < rect.width / 2;
                const score = isHalf ? index - 0.5 : index;
                updateStars(score);
                scoreDisplay.textContent = score.toFixed(1) + ' / 5.0';
            });

            star.addEventListener('click', function(e) {
                if (rated) return;
                rated = true;
                const index = parseInt(this.getAttribute('data-index'));
                const rect = this.getBoundingClientRect();
                const isHalf = (e.clientX - rect.left) < rect.width / 2;
                const score = isHalf ? index - 0.5 : index;
                updateStars(score);
                scoreDisplay.textContent = score.toFixed(1) + ' / 5.0';

                // Á¶ÅÁî®ËØÑÂàÜ
                starsContainer.classList.add('disabled');

                // ÊòæÁ§∫ÊÑüË∞¢
                const ratingResult = document.getElementById('ratingResult');
                ratingResult.style.display = 'block';
                ratingResult.textContent = 'Thank you for rating!';

                // ÂèëÈÄÅËØÑÂàÜÂà∞ÈÇÆÁÆ±
                emailjs.send('service_xu6cwtj', 'template_vxnxlwl', {
                    from_name: 'Valentine Page',
                    message: 'She clicked "I Would" and rated the poem: ' + score.toFixed(1) + ' / 5.0',
                    to_email: 'huanchengch@gmail.com'
                }).then(() => {
                    console.log('ËØÑÂàÜÈÇÆ‰ª∂Â∑≤ÂèëÈÄÅ:', score);
                }).catch((e) => {
                    console.log('ÈÇÆ‰ª∂ÂèëÈÄÅÂ§±Ë¥•:', e);
                });
            });
        });

        // Èº†Ê†áÁ¶ªÂºÄÊó∂ÈáçÁΩÆÔºàÂ¶ÇÊûúËøòÊ≤°ËØÑÂàÜÔºâ
        starsContainer.addEventListener('mouseleave', () => {
            if (!rated) {
                updateStars(0);
                scoreDisplay.textContent = '';
            }
        });

        // "ÊÆãÂøçÊãíÁªù"ÊåâÈíÆË∫≤ÈÅøÊïàÊûúÔºàÂèØÈÄâÔºâ
        btnNo.addEventListener('mouseenter', function(e) {
            const x = Math.random() * (window.innerWidth - this.offsetWidth);
            const y = Math.random() * (window.innerHeight - this.offsetHeight);
            this.style.position = 'absolute';
            this.style.left = x + 'px';
            this.style.top = y + 'px';
        });
    </script>
</body>
</html>